\batchmode
% op-ot-tla.tex

\documentclass{article}
\usepackage{graphicx}
\usepackage{tlatex}
\usepackage{color}
\definecolor{boxshade}{gray}{.85}
\setboolean{shading}{true}

\begin{document}
\makeatletter
\chardef\%=`\%
\fl{}\moduleLeftDash\cl{ {\MODULE} OT}\moduleRightDash\cl{}
 \fl{ Del}\al{1}{1}{ \.{\defeq}}\al{1}{2}{ [ type}\al{1}{4}{ \.{:}}\al{1}{5}{
 \{\@w{Del} \} ,\, pos}\al{1}{10}{ \.{:}}\al{1}{11}{ Nat ]%
\@y{%
  The positions ($pos$) are indexed from 1.
}%
}
 \fl{ Ins}\al{2}{1}{ \.{\defeq}}\al{2}{2}{ [ type}\al{2}{4}{ \.{:}}\al{2}{5}{
 \{\@w{Ins} \} ,\, pos}\al{2}{10}{ \.{:}}\al{2}{11}{ Nat ,\, ch \.{:} Char
 ,\, pr \.{:} 1 \.{\dotdot} Cardinality ( Client ) ]}
\fl{ Op \.{\defeq} Ins \.{\cup} Del%
\@y{%
  The set of all possible update operations.
}%
}
\fl{}\midbar\cl{}
\fl{ OTID}\al{5}{1}{ ( ins ,\, del ) \.{\defeq}%
\@y{%
  $ins$ is transformed against $del$; $I$ for $Ins$ and $D$ for $Del$.
}%
}
 \fl{ {\IF} ins . pos \.{\leq} del . pos \.{\THEN} ins \.{\ELSE} [ ins
 {\EXCEPT} {\bang} . pos \.{=} @ \.{-} 1 ]}
\fl{ OT ( lop ,\, rop ) \.{\defeq}%
\@y{%
  Calls $OTII$, $OTID$, $OTDI$, or $OTDD$ to transform $lop$ against $rop$.
}%
}
\fl{}\bottombar\cl{}
\end{document}
